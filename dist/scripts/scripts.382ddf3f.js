"use strict";angular.module("dCraftApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngMaterial","ngMessages"]).config(["$mdThemingProvider",function(a){a.theme("default").primaryPalette("light-blue",{"default":"800","hue-1":"300","hue-2":"500","hue-3":"A100"}).accentPalette("grey",{"default":"600"})}]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).when("/new-character",{templateUrl:"views/new-character.html",controller:"NewCharCtrl",controllerAs:"newChar"}).when("/character",{templateUrl:"views/character/home.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/profile",{templateUrl:"views/character/profile/index.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/profile/basic-info",{templateUrl:"views/character/profile/basic.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/profile/appearance",{templateUrl:"views/character/profile/appearance.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/profile/history",{templateUrl:"views/character/profile/history.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/profile/proficiency",{templateUrl:"views/character/profile/proficiency.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/profile/traits",{templateUrl:"views/character/profile/traits.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/profile/feats",{templateUrl:"views/character/profile/feats.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/stats",{templateUrl:"views/character/stats/index.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/stats/base",{templateUrl:"views/character/stats/base.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/stats/saving-throws",{templateUrl:"views/character/stats/saving-throws.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/stats/skills",{templateUrl:"views/character/stats/skills.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/stats/combat",{templateUrl:"views/character/stats/combat.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/spells",{templateUrl:"views/character/spells/index.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/spells/my-spells",{templateUrl:"views/character/spells/my-spells.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/spells/class-spells",{templateUrl:"views/character/spells/class-spells.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/spells/all-spells",{templateUrl:"views/character/spells/all-spells.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/equipment",{templateUrl:"views/character/equipment/index.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/equipment/weapons",{templateUrl:"views/character/equipment/weapons.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/equipment/armor",{templateUrl:"views/character/equipment/armor.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/equipment/inventory",{templateUrl:"views/character/equipment/inventory.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/character/equipment/currency",{templateUrl:"views/character/equipment/currency.html",controller:"CharacterCtrl",controllerAs:"character"}).when("/settings",{templateUrl:"views/settings.html",controller:"AdminCtrl",controllerAs:"settings"}).otherwise({redirectTo:"/"})}]).run(["$rootScope","$location",function(a,b){console.log("running!");localStorage;Storage.prototype.setObject=function(a,b){this.setItem(a,JSON.stringify(b))},Storage.prototype.getObject=function(a){var b=this.getItem(a);return b},a.$on("$locationChangeStart",function(a,c,d,e){console.log("Location change start!"),console.log("path: "+b.path())}),a.$on("$locationChangeSuccess",function(b,c,d,e){console.log("Location change success!"),console.log("old URL: "+d),console.log("new URL: "+c),a.scrollTo("top"),a.lastPage=d});var c=new Dexie("test-database");c.version(1).stores({charClasses:"name",characters:"id++,name,race,subrace,class,level,gender",race:"id++,name,subraces",gender:"name"}),c.open(),a.populate=function(){c.on("populate",function(){c.charClasses.add({name:"Barbarian"}),c.charClasses.add({name:"Bard"}),c.charClasses.add({name:"Cleric"}),c.charClasses.add({name:"Druid"}),c.charClasses.add({name:"Fighter"}),c.charClasses.add({name:"Monk"}),c.charClasses.add({name:"Paladin"}),c.charClasses.add({name:"Ranger"}),c.charClasses.add({name:"Rogue"}),c.charClasses.add({name:"Sorcerer"}),c.charClasses.add({name:"Warlock"}),c.charClasses.add({name:"Wizard"}),c.race.add({name:"Dwarf",subraces:"Hill Dwarf,Mountain Dwarf"}),c.race.add({name:"Elf",subraces:"High Elf,Wood Elf,Dark Elf"}),c.race.add({name:"Halfling",subraces:"Lightfoot,Stout"}),c.race.add({name:"Human",subraces:"Calishite,Chondathan,Damaran,Mulan,Rashemi,Shou,Tethyrian,Turami"}),c.race.add({name:"Dragonborn",subraces:"Black,Blue,Brass,Bronze,Copper,Gold,Green,Red,Silver,White"}),c.race.add({name:"Gnome",subraces:"Forest Gnome,Rock Gnome"}),c.race.add({name:"Half-Elf",subraces:"None"}),c.race.add({name:"Half-Orc",subraces:"None"}),c.race.add({name:"Tiefling",subraces:"None"}),c.gender.add({name:"Male"}),c.gender.add({name:"Female"}),c.gender.add({name:"None"})})},a.populate(),a.deleteDB=function(){console.log("Deleting the DB"),c["delete"](),c.close(),c.open()},a.selectCharacter=function(b){c.open(),c.characters.where("id").equals(b).each(function(b){console.log("selected character: "+b.name),a.selectedCharacter=b,a.$digest()}).then(function(){localStorage.setObject("character",a.selectedCharacter),console.log(localStorage.getObject("character"))})["catch"](function(a){console.error(a)}),c.close(),a.go("/character")},c.close()}]).controller("AppCtrl",["$scope","$rootScope","$location","$timeout","$mdSidenav","$mdUtil","$log","$mdDialog","$anchorScroll",function(a,b,c,d,e,f,g,h,i){function j(a){var b=f.debounce(function(){e(a).toggle().then(function(){g.debug("toggle "+a+" is done")})},200);return b}b.selectedID="",a.toggleLeft=j("left"),a.toggleRight=j("right"),a.toggleLeft=function(){e("left").toggle().then(function(){g.debug("toggle left is done")})},b.go=function(a){c.path(a)},b.goBack=function(){window.history.back()},b.scrollTo=function(a){i(a)};var k;this.openMenu=function(a,b){k=b,a(b)},this.announceClick=function(a){h.show(h.alert().title("You clicked!").content("You clicked the menu item at index "+a).ok("Nice").targetEvent(k)),k=null},a.menu=[{text:"Characters",icon:"people",href:"/"},{text:"Settings",icon:"settings",href:"/settings"}]}]).controller("LeftCtrl",["$scope","$timeout","$mdSidenav","$log",function(a,b,c,d){a.close=function(){c("left").close().then(function(){d.debug("close LEFT is done")})}}]),angular.module("dCraftApp").controller("MainCtrl",["$scope","$rootScope",function(a,b){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],b.characterList||(b.characterList=[]);var c=new Dexie("test-database");c.version(1).stores({characters:"name,class"}),c.open(),a.showCharacters=!1,a.getCharacters=function(){console.log("charList:"),console.log(b.characterList.length),void 0==b.characterList||0==b.characterList.length?(console.log("EMPTY!!!"),a.gettingCharacters=!0,b.characterList=[],c.characters.each(function(a){console.log("runnisng!"),console.log("class: "+JSON.stringify(a["class"])),b.characterList.push({id:a.id,name:a.name,race:a.race,"class":a["class"]}),console.log(b.characterList)}).then(function(){a.showCharacters=!0,a.gettingCharacters=!1,b.$digest()})):(a.showCharacters=!0,a.gettingCharacters=!1)},a.getCharacters()}]),angular.module("dCraftApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("dCraftApp").controller("NewCharCtrl",["$scope","$rootScope","$mdDialog",function(a,b,c){function d(a,b,c){a.hide=function(){c.hide(),b["char"]["class"]=""},a.cancel=function(a){c.cancel(),b["char"][a]=""},a.answer=function(a){c.hide(a)},a.addCustomClass=function(a,d){f.charClasses.add({name:a,description:d}),b.getClasses(),b["char"]["class"]=a,c.hide()},a.addCustomRace=function(a,d,g){f.race.add({name:a,description:d,subraces:g}),e.push({name:a,description:d,subraces:g}),b.getRaces(),b["char"].race=a,b.updateSubrace(a),c.hide()},a.addCustomSubrace=function(a,d){console.log("new subrace:"+a+" for: "+d),f.race.where("name").equalsIgnoreCase(d).each(function(g){g.subraces+=","+a,console.log("subraces: "+g.subraces),f.race.update(g.id,{subraces:g.subraces}).then(function(){for(var f in e)console.log("the "+f),f.name==d&&(console.log("update "+f),f.subraces=g.subraces);b.updateSubrace(d),b["char"].subrace=a,c.hide()})})},a.addCustomGenger=function(a){f.gender.add({name:a}),b.getGenders(),b["char"].gender=a,c.hide()}}a.classArray=[];var e=[];a.characterArray=[],b.raceArray=[],b.genderArray=[];var f=new Dexie("test-database");f.version(1).stores({charClasses:"name,description",characters:"name,race,subrace,class,level,gender",race:"id++,name,subraces",gender:"name"}),f.open(),b.getRaces=function(){b.raceArray=[],f.race.each(function(a){b.raceArray.push({name:a.name,subraces:a.subraces})}).then(function(a){e=b.raceArray})},b.getClasses=function(){a.classArray=[],f.charClasses.each(function(b){a.classArray.push(b.name)})},b.getGenders=function(){b.genderArray=[],f.gender.each(function(a){b.genderArray.push({name:a.name})})},b.getRaces(),b.getClasses(),b.getGenders(),a.addCharacter=function(a,c,d,e,g,h){f.characters.add({name:a,race:c,subrace:d,"class":e,level:g,gender:h}),b.characterList=[]},b.updateSubrace=function(a){for(var c in e)c.name==a&&c.subraces&&(b.subraceArray=c.subraces.split(","))},b["char"]={name:"","class":"",race:"",subrace:"",level:1,gender:""},a.showDialog=function(a,b){var e="";switch(b){case"race":e="../views/templates/dialog/custom-race.tmpl.html";break;case"subrace":e="../views/templates/dialog/custom-subrace.tmpl.html";break;case"class":e="../views/templates/dialog/custom-class.tmpl.html";break;case"gender":e="../views/templates/dialog/custom-gender.tmpl.html"}c.show({controller:d,templateUrl:e,parent:angular.element(document.body),targetEvent:a,clickOutsideToClose:!1})},d.$inject=["$scope","$rootScope","$mdDialog"],f.close()}]),angular.module("dCraftApp").controller("CharacterCtrl",["$scope","$rootScope",function(a,b){var c=new Dexie("test-database");c.version(1).stores({charClasses:"name,description",characters:"name,race,subrace,class,level,gender",race:"id++,name,subraces",gender:"name"}),b.getRaces=function(){c.open(),b.raceArray=[],c.race.each(function(a){b.raceArray.push({name:a.name,subraces:a.subraces})}).then(function(a){b.$digest()}),c.close()};var d=JSON.parse(localStorage.getObject("character"));"undefined"==d?(console.log("adding character to localstorage"),localStorage.setObject("character",b.selectedCharacter)):void 0==b.selectedCharacter&&(console.log("character is undefined"),console.log(d),b.selectedCharacter=d),a["char"]=b.selectedCharacter,b.getRaces()}]),angular.module("dCraftApp").controller("AdminCtrl",["$scope","$rootScope",function(a,b){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],console.log("test");var c=new Dexie("test-database");c.version(1).stores({charClasses:"name,description",characters:"name,class"})}]),angular.module("dCraftApp").run(["$templateCache",function(a){a.put("views/templates/dialog/custom-class.tmpl.html",'<md-dialog aria-label="Add Custom Class"> <form> <md-toolbar> <div class="md-toolbar-tools"> <h2>Add Custom Class</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel(\'class\')"> <i class="material-icons">close</i> </md-button> </div> </md-toolbar> <md-dialog-content style="max-width:800px;max-height:810px"> <div> <md-input-container> <label class="md-accent">Class Name</label> <input class="md-accent" ng-model="customClass.name" type="text"> </md-input-container> <md-input-container> <label class="md-accent">Description (optional)</label> <textarea class="md-accent" ng-model="customClass.description" type="text" md-maxlength="200"></textarea> </md-input-container> </div> </md-dialog-content> <div class="md-actions" layout="row"> <md-button ng-click="cancel(\'class\')"> Cancel </md-button> <md-button ng-click="addCustomClass(customClass.name, customClass.description)" style="margin-right:20px"> Confirm </md-button> </div> </form> </md-dialog>'),a.put("views/templates/dialog/custom-gender.tmpl.html",'<md-dialog aria-label="Add Custom Race"> <form> <md-toolbar> <div class="md-toolbar-tools"> <h2>Add Custom Gender</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel(\'gender\')"> <i class="material-icons">close</i> </md-button> </div> </md-toolbar> <md-dialog-content style="max-width:800px;max-height:810px"> <div> <md-input-container> <label class="md-accent">Gender Name</label> <input class="md-accent" ng-model="customGender.name" type="text"> </md-input-container> </div> </md-dialog-content> <div class="md-actions" layout="row"> <md-button ng-click="cancel(\'gender\')"> Cancel </md-button> <md-button ng-click="addCustomGender(customGender.name)"> Confirm </md-button> </div> </form> </md-dialog>'),a.put("views/templates/dialog/custom-race.tmpl.html",'<md-dialog aria-label="Add Custom Race"> <form> <md-toolbar> <div class="md-toolbar-tools"> <h2>Add Custom Race</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel(\'race\')"> <i class="material-icons">close</i> </md-button> </div> </md-toolbar> <md-dialog-content style="max-width:800px;max-height:810px"> <div> <md-input-container> <label class="md-accent">Race Name</label> <input class="md-accent" ng-model="customRace.name" type="text"> </md-input-container> <md-input-container> <label class="md-accent">Description (optional)</label> <textarea class="md-accent" ng-model="customRace.description" type="text" md-maxlength="200"></textarea> </md-input-container> <md-input-container> <label class="md-accent">Subraces (optional)*</label> <textarea class="md-accent" ng-model="customRace.subraces" type="text" md-maxlength="200"></textarea> </md-input-container> <p class="sub-text">*Seperate subraces with a \',\' (no spaces).</p> </div> </md-dialog-content> <div class="md-actions" layout="row"> <md-button ng-click="cancel(\'race\')"> Cancel </md-button> <md-button ng-click="addCustomRace(customRace.name, customRace.description, customRace.subraces)"> Confirm </md-button> </div> </form> </md-dialog>'),a.put("views/templates/dialog/custom-subrace.tmpl.html",'<md-dialog aria-label="Add Custom Race"> <form> <md-toolbar> <div class="md-toolbar-tools"> <h2>Add Custom Subrace</h2> <span flex></span> <md-button class="md-icon-button" ng-click="cancel(\'subrace\')"> <i class="material-icons">close</i> </md-button> </div> </md-toolbar> <md-dialog-content style="max-width:800px;max-height:810px"> <div> <p>Add a new {{$root.char.race}} subrace.</p> <md-input-container> <label class="md-accent">Subrace Name</label> <input class="md-accent" ng-model="customSubrace.name" type="text"> </md-input-container> </div> </md-dialog-content> <div class="md-actions" layout="row"> <md-button ng-click="cancel(\'subrace\')"> Cancel </md-button> <md-button ng-click="addCustomSubrace(customSubrace.name, $root.char.race)"> Confirm </md-button> </div> </form> </md-dialog>')}]);